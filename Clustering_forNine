import json
import pickle
import numpy as np

from scipy.cluster.hierarchy import linkage, fcluster
from sklearn.feature_extraction.text import TfidfVectorizer

# This is a re-clustering for label 9 that has most of all posts.


with open("labelNineTexts.txt", "rb") as f:
    texts9 = pickle.load(f)
with open("subNine.txt", "rb") as f:
    sub9 = pickle.load(f)


vectorizer = TfidfVectorizer(stop_words="english")
vecs = vectorizer.fit_transform(texts9)
v = vecs.toarray()
print("vectorizing done")

# calculate distances *takes much time
z = linkage(v, metric='cosine')
print("linkage done")


numClust = 20
group = fcluster(z, t=numClust, criterion='maxclust')
key, count = np.unique(group, return_counts=True)
for k, c in zip(key, count):
    print(k, c)

# Result
# 1 2
# 2 2
# 3 2
# 4 2
# 5 2
# 6 2
# 7 2
# 8 1356
# 9 1
# 10 1
# 11 1
# 12 1
# 13 1
# 14 1
# 15 1
# 16 1
# 17 1
# 18 1
# 19 1
# 20 1